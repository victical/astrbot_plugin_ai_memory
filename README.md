# AstrBot 记忆插件

一个为 AstrBot 提供记忆功能的插件，让 AI 能够记住对话中的重要信息。

## 功能特性

- **多场景适配**：私聊记忆与群聊记忆独立管理，支持全局群聊记忆模式。
- **重要性权重**：记忆按重要程度（1-5）排序，支持 ⭐ 星级显示。
- **智能淘汰**：自动管理记忆容量，超出时优先删除最不重要的记忆。
- **AI 交互工具**：AI 可以在对话时自动保存信息、搜索记忆并参考历史背景。
- **精细化管理**：支持手动添加、编辑、删除、搜索以及统计记忆数据。

## 安装方法

1. 将 `ai_memory` 文件夹放入 AstrBot 的 `data/plugins/` 目录。
2. 重启 AstrBot 即可自动加载。

## 配置项说明

在 AstrBot 管理面板中可进行以下配置：

| 配置项 | 说明 | 默认值 |
| :--- | :--- | :--- |
| `max_memories` | 每个会话最大记忆存储数量 (1-100) | 10 |
| `auto_save_enabled` | 是否允许 AI 自动保存发现的重要信息 | true |
| `importance_threshold` | AI 自动保存的最低重要性阈值 (1-5) | 3 |
| `memory_expire_days` | 记忆过期天数，0 表示永不过期 | 30 |
| `enable_auto_injection` | 是否启用记忆自动注入（回复前自动参考背景） | true |
| `enable_global_memory` | 是否启用全局群聊记忆（所有群聊共享） | false |
| `allowed_groups` | 允许使用记忆指令的群号（留空则不限制） | "" |

## 指令列表

### 🔍 查看与搜索
- `/memory list` - 列出当前会话的记忆（私聊独立，群聊受全局开关影响）。
- `/memory list_group [群号]` - 查询指定或当前群聊的记忆。
- `/memory search <关键词>` - 在当前会话中搜索相关记忆。
- `/memory stats` - 查看当前会话的记忆统计报告。
- `/memory list_all` - **(管理员)** 列出数据库中所有的记忆详单。

### ✏️ 手动维护
- `/memory add <内容>` - 手动记录一条信息（默认 3 级重要性）。
- `/memory edit <序号> <新内容>` - 修改已存在的记忆正文。
- `/memory update <序号> <重要性>` - 调整记忆的重要性等级 (1-5)。

### 🗑️ 清理操作
- `/memory remove <序号>` - 删除指定的单条记忆。
- `/memory clear` - 清空当前会话的所有记忆。

### ⚙️ 辅助指令
- `/memory_config` - 显示当前插件的运行配置。
- `/memory_reset_config` - 将所有配置重置为默认值。
- `/mem_help` - 显示详细的帮助菜单。

## 使用演示

![演示](image/示例.png)
![后台](image/后台调用.png)

## 更新日志

### v1.1.0
- **【核心升级】新增记忆自动注入功能**：AI 在回复前会自动检索并参考当前会话最重要的记忆，不再需要手动调用工具。
- 完善了配置项，支持开关自动注入功能。
- 优化了代码结构，提升了注入逻辑的稳定性。

### v1.0.5

## 作者

- 作者：kjqwdw、victical
- 版本：v1.0.5

## 支持

如需帮助，请参考 [AstrBot插件开发文档](https://astrbot.soulter.top/center/docs/%E5%BC%80%E5%8F%91/%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/)
